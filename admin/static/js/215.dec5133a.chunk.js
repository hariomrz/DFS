(this["webpackJsonp@coreui/coreui-pro-react-admin-template-starter"]=this["webpackJsonp@coreui/coreui-pro-react-admin-template-starter"]||[]).push([[215],{982:function(t,e,a){"use strict";a.r(e);var n=a(11),i=a(12),c=a(15),l=a(14),o=a(0),s=a.n(o),r=a(155),d=a(156),u=a(154),m=a(516),p=a(8),E=(a(9),a(18)),v=a(507),h=a.n(v),y=a(5),g=a.n(y),A=a(24),f=a(59),b=a(539),_=a(538),O=a(499),P=a(542),C=a(10),S=a(158),R=a(514),N=a(511),j=function(t){Object(c.a)(a,t);var e=Object(l.a)(a);function a(t){var i;return Object(n.a)(this,a),(i=e.call(this,t)).getActivity=function(){Object(R.tc)({}).then((function(t){if(t.response_code==p.qk){var e=t.data?t.data:[],a=[];Object(C.a)(e,(function(t){a.push({value:t.activity_master_id,label:t.activity_title,activity_type:t.activity_type})})),i.setState({ActOptions:a})}else E.notify.show(p.Ri,"error",3e3)})).catch((function(t){E.notify.show(p.Ri,"error",3e3)}))},i.getCount=function(){var t=[];Object(C.h)(101,(function(e){0!==e&&t.push({value:e,label:e})})),i.setState({CountOption:t})},i.handleSelectChange=function(t,e){var a;Object(C.e)(t)||i.setState((a={},Object(f.a)(a,e,t.value),Object(f.a)(a,"EditForm",!1),a),(function(){"ActivitySelect"==e&&i.setState({ActType:t.activity_type})}))},i.handleInputChange=function(t){if(t){var e=t.target.getAttribute("data-inp"),a=t.target.value;i.setState({EarnPoints:a,EditForm:!1},(function(){if(Number(i.state.EarnPoints)<1||Number(i.state.EarnPoints)>99999){var t=e+" value should be between 1 to 100000";return E.notify.show(t,"error",3e3),i.setState({EarnPoints:""}),!1}}))}},i.addActivity=function(){var t=i.state,e=t.ActivitySelect,a=t.CountSelect,n=t.EarnPoints,c=t.ActType;if(Object(C.d)(e)&&Object(C.d)(i.props.EditRItem))return E.notify.show(N.fc,"error",1500),!1;if("2"==c&&Object(C.d)(a.toString()))return E.notify.show(N.gc,"error",1500),!1;if(Object(C.d)(n))return E.notify.show(N.cc,"error",1500),!1;var l={activity_master_id:e,xp_point:n,recurrent_count:a};i.setState({addActPosting:!0});var o=R.nc;Object(C.f)(i.props.EditRItem.activity_id)||(l.activity_id=i.props.EditRItem.activity_id,delete l.activity_master_id,o=R.wc),o(l).then((function(t){t.response_code==p.qk?(i.setState({ActivitySelect:"",CountSelect:"",EarnPoints:"",EditForm:!0}),E.notify.show(t.message,"success",3e3),i.props.modalActioYesCallback()):E.notify.show(p.Ri,"error",3e3),i.setState({addActPosting:!1})})).catch((function(t){E.notify.show(p.Ri,"error",3e3)}))},i.changeEditState=function(){i.state.EarnPoints!=i.props.EditRItem.xp_point&&i.setState({EarnPoints:i.props.EditRItem.xp_point,CountSelect:i.props.EditRItem.recurrent_count,ActType:i.props.EditRItem.activity_type})},i.state={ActOptions:[],CountOption:[],ActivitySelect:"",CountSelect:"",EarnPoints:"",ActType:"",addActPosting:!1,EditForm:!0},i}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.getActivity(),this.getCount()}},{key:"render",value:function(){var t=this,e=this.props,a=e.modalCallback,n=e.AddActiModalOpen,i=e.EditRItem,c=(e.EditFlag,this.state),l=c.ActType,o=c.ActOptions,m=c.ActivitySelect,p=c.CountSelect,E=c.CountOption,v=c.EarnPoints,h=c.addActPosting;c.EditForm&&!Object(C.d)(i)&&this.changeEditState();var y={is_disabled:!1,is_searchable:!1,is_clearable:!1,menu_is_open:!1,class_name:"custom-form-control",place_holder:"Select",modalCallback:function(e,a){return t.handleSelectChange(e,a)}},g=Object(A.a)(Object(A.a)({},y),{},{sel_options:o,selected_value:m,select_name:"ActivitySelect"}),f=Object(A.a)(Object(A.a)({},y),{},{sel_options:E,selected_value:p,select_name:"CountSelect"});return s.a.createElement(b.a,{isOpen:n,toggle:a,className:"addrewards-modal modal-md addact-modal animate-modal-top"},s.a.createElement(_.a,null,s.a.createElement(r.a,null,s.a.createElement(d.a,{md:12},s.a.createElement("h3",{className:"h3-cls"},i.activity_id?"Update":"Add"," Activities"))),s.a.createElement(r.a,null,s.a.createElement(d.a,{md:6},s.a.createElement("div",{className:"input-box"},s.a.createElement("label",null,"Select Activity"),i.activity_id?s.a.createElement("div",{className:"xp-sel-title"},i?i.activity_title:""):s.a.createElement(S.a,{SelectProps:g}),s.a.createElement("span",{className:"act-type"},"1"==l&&"One time","2"==l&&"Recurrent"))),s.a.createElement(d.a,{md:6},s.a.createElement("div",{className:"input-box ".concat("2"==l?"opc-1":"opc-0")},s.a.createElement("label",null,"Count"),s.a.createElement(S.a,{SelectProps:f})))),s.a.createElement(r.a,null,s.a.createElement(d.a,{md:6},s.a.createElement("div",{className:"input-box"},s.a.createElement("label",null,"Earn Points"),s.a.createElement(O.a,{className:"form-control",type:"number",placeholder:"Points",name:"EarnPoints",value:v,"data-inp":"Earn points",onChange:function(e){return t.handleInputChange(e)}}))))),s.a.createElement(P.a,null,s.a.createElement(u.a,{disabled:h,className:"btn-secondary-outline",onClick:this.addActivity},i.activity_id?"Update":"Add"," Activity")))}}]),a}(o.Component),k=a(157),w=a(565),M=function(t){Object(c.a)(a,t);var e=Object(l.a)(a);function a(t){var i;return Object(n.a)(this,a),(i=e.call(this,t)).getActivityList=function(){i.setState({listPosting:!0});var t=i.state,e={items_perpage:t.PERPAGE,current_page:t.CURRENT_PAGE,sort_order:t.isDescOrder?"DESC":"ASC",sort_field:t.sortField};Object(R.sc)(e).then((function(t){t.response_code==p.qk?i.setState({ActivityList:t.data?t.data.activities_list:[],Total:t.data?t.data.total:0,listPosting:!1}):E.notify.show(p.Ri,"error",3e3)})).catch((function(t){E.notify.show(p.Ri,"error",3e3)}))},i.toggleActionPopup=function(t,e){t||(e={}),i.setState({AddActiModalOpen:!i.state.AddActiModalOpen,EditRItem:e,EditFlag:t})},i.toggleYesActionPopup=function(){i.setState({AddActiModalOpen:!1},(function(){i.getActivityList()}))},i.deleteToggle=function(t,e){i.setState((function(a){return{delIdx:e,ACT_ID:t,DeleteModalOpen:!a.DeleteModalOpen}}))},i.deleteReward=function(){i.setState({DeletePosting:!0});var t=i.state,e=t.delIdx,a={activity_id:t.ACT_ID},n=t.ActivityList;Object(R.pc)(a).then((function(t){t.response_code===p.qk&&(Object(C.g)(n,(function(t,a){return a==e})),E.notify.show(t.message,"success",5e3),i.setState({ActivityList:n,DeletePosting:!1,DeleteModalOpen:!1,Total:n.length}))})).catch((function(t){E.notify.show(p.Ri,"error",5e3)}))},i.state={PERPAGE:p.Vf,CURRENT_PAGE:1,sortField:"activity_id",isDescOrder:"true",AddActiModalOpen:!1,listPosting:!1,DeleteModalOpen:!1},i}return Object(i.a)(a,[{key:"componentDidMount",value:function(){"0"==C.i.allowXpPoints()&&(E.notify.show(p.og,"error",5e3),this.props.history.push("/dashboard")),this.getActivityList()}},{key:"sortByColumn",value:function(t,e){var a=!e;this.setState({sortField:t,isDescOrder:a,CURRENT_PAGE:1},this.getActivityList)}},{key:"handlePageChange",value:function(t){var e=this;t!==this.state.CURRENT_PAGE&&this.setState({CURRENT_PAGE:t},(function(){e.getActivityList()}))}},{key:"render",value:function(){var t=this,e=this.state,a=e.ActivityList,n=e.CURRENT_PAGE,i=e.PERPAGE,c=e.Total,l=e.AddActiModalOpen,o=e.Message,E=e.isDescOrder,v=e.sortField,y=e.listPosting,A=e.DeleteModalOpen,f=e.DeletePosting,b=e.EditRItem,_={Message:o,modalCallback:this.toggleActionPopup,AddActiModalOpen:l,modalActioYesCallback:this.toggleYesActionPopup,EditRItem:b},O={publishModalOpen:A,publishPosting:f,modalActionNo:this.deleteToggle,modalActionYes:this.deleteReward,MainMessage:N.ac,SubMessage:N.bc};return s.a.createElement("div",{className:"rewards-level animated fadeIn"},l&&s.a.createElement(j,_),A&&s.a.createElement(w.a,O),s.a.createElement(r.a,{className:"level-sub-header mb-20"},s.a.createElement(d.a,{xs:6},s.a.createElement("h2",null,"Activities:")),s.a.createElement(d.a,{xs:6,className:"text-right"},s.a.createElement(u.a,{className:"btn-secondary-outline",onClick:function(){return t.toggleActionPopup()}},"Add Activities"))),s.a.createElement("div",{className:"white-container"},s.a.createElement(r.a,null,s.a.createElement(d.a,{md:12,className:"table-responsive common-table"},s.a.createElement(m.a,null,s.a.createElement("thead",{className:"height-40"},s.a.createElement("tr",null,s.a.createElement("th",{onClick:function(){return t.sortByColumn("activity_id",E)}},"Activity",s.a.createElement("div",{className:"d-inline-block ".concat("activity_id"===v&&E?"":"rotate-icon")},s.a.createElement("i",{className:"icon-Shape ml-1"}))),s.a.createElement("th",{className:"cursor-default"},"Points"),s.a.createElement("th",{className:"cursor-default"},"Type"),s.a.createElement("th",{className:"text-center cursor-default"},"Action"))),c>0?g.a.map(a,(function(e,a){return s.a.createElement("tbody",{key:a},s.a.createElement("tr",null,s.a.createElement("td",null,e.activity_title),s.a.createElement("td",null,e.xp_point),s.a.createElement("td",null,"1"==e.activity_type&&"One time","2"==e.activity_type&&"Recurrent"),s.a.createElement("td",{className:"text-center"},s.a.createElement("a",{className:"action-icn",onClick:function(){return t.toggleActionPopup(!0,e)}},s.a.createElement("i",{className:"icon-edit"})),s.a.createElement("a",{className:"action-icn",onClick:function(){return t.deleteToggle(e.activity_id,a)}},s.a.createElement("i",{className:"icon-delete"})))))})):s.a.createElement("tbody",null,s.a.createElement("tr",null,s.a.createElement("td",{colSpan:"22"},0!=c||y?s.a.createElement(k.a,null):s.a.createElement("div",{className:"no-records"},p.Cg)))))))),c>i&&s.a.createElement("div",{className:"custom-pagination lobby-paging"},s.a.createElement(h.a,{activePage:n,itemsCountPerPage:i,totalItemsCount:c,pageRangeDisplayed:5,onChange:function(e){return t.handlePageChange(e)}})))}}]),a}(o.Component);e.default=M}}]);
//# sourceMappingURL=215.dec5133a.chunk.js.map